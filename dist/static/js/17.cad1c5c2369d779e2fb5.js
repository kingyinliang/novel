webpackJsonp([17],{"65fe":function(t,e){},fw8R:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("Dd8w"),o=n.n(a),i=n("NYxO"),c=n("dw9j"),s=n("P9l9"),m=n("Au9i"),r={name:"commentList",data:function(){return{pageNo:1,commentmain:"",number:0,bookcomment:[],totalCount:0}},mounted:function(){this.getcomment()},methods:{getcomment:function(){var t=this;m.Indicator.open(),Object(c.a)(""+s.a.BOOKCOMMENT_API,"GET",{pageNo:this.pageNo,pageSize:10,book_serial_num:this.detailid}).then(function(e){m.Indicator.close(),t.bookcomment=e.data.list,t.totalCount=e.data.totalCount})},getmore:function(){var t=this;if(this.pageNo++,this.pageNo>Math.ceil(this.totalCount/10))return Object(m.Toast)({message:"暂无更多评论",duration:1e3}),!1;m.Indicator.open(),Object(c.a)(""+s.a.BOOKCOMMENT_API,"GET",{pageNo:this.pageNo,pageSize:10,book_serial_num:this.detailid}).then(function(e){m.Indicator.close(),t.bookcomment=t.bookcomment.concat(e.data.list),t.totalCount=e.data.totalCount})},chages:function(){this.number=this.commentmain.length},addcomment:function(){var t=this;if(0===this.commentmain.length)return!1;m.Indicator.open(),Object(c.a)(""+s.a.ADDCOMMENT_API,"POST",{book_serial_num:this.detailid,content:this.commentmain}).then(function(e){m.Indicator.close(),0===e.data.code?(Object(m.Toast)({message:"评论成功",duration:2e3}),t.getcomment()):20001===e.data.code?m.MessageBox.alert("请登录后评论").then(function(e){t.$router.push({path:"/login"})}):Object(m.Toast)({message:e.data.msg,duration:2e3})})}},computed:o()({},Object(i.c)({detailid:function(t){return t.detail.detailid}})),components:{Heads:function(t){n.e(27).then(function(){var e=[n("2Hch")];t.apply(null,e)}.bind(this)).catch(n.oe)},Commentlist:function(t){n.e(31).then(function(){var e=[n("oM2w")];t.apply(null,e)}.bind(this)).catch(n.oe)},Gotop:function(t){n.e(28).then(function(){var e=[n("ZrgH")];t.apply(null,e)}.bind(this)).catch(n.oe)}}},l={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("heads",{attrs:{tit:"书评区（共"+t.totalCount+"条）"}}),t._v(" "),n("div",{staticClass:"textarea"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.commentmain,expression:"commentmain"}],ref:"textareas",attrs:{placeholder:"输入文字如下",maxlength:"300"},domProps:{value:t.commentmain},on:{input:[function(e){e.target.composing||(t.commentmain=e.target.value)},t.chages]}}),t._v(" "),n("span",[t._v(t._s(t.number)+"/300字")]),t._v(" "),n("a",{on:{click:t.addcomment}},[t._v("发表评论")])]),t._v(" "),t._m(0),t._v(" "),n("commentlist",{attrs:{bookcomment:t.bookcomment}}),t._v(" "),n("div",{staticClass:"more",on:{click:t.getmore}},[n("p",[t._v("查看更多书评")])]),t._v(" "),n("gotop")],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tab clearfix"},[e("a",{staticClass:"active"},[e("span",[this._v("最新书评")]),this._v(" "),e("i")])])}]};var u=n("VU/8")(r,l,!1,function(t){n("65fe")},"data-v-530d2db7",null);e.default=u.exports}});